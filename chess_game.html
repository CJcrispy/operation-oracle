<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ORACLE Challenge - chess.exe</title>
  <style>
    body {
      margin: 0;
      background: #008080;
      font-family: 'MS Sans Serif', sans-serif;
      color: black;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    .window {
      width: 420px;
      background: #C0C0C0;
      border: 2px solid black;
      box-shadow: 4px 4px 0 #404040;
    }

    .titlebar {
      background: #000080;
      color: white;
      padding: 6px;
      font-weight: bold;
    }

    #container {
      display: grid;
      grid-template-columns: repeat(8, 48px);
      grid-template-rows: repeat(8, 48px);
      width: 384px;
      height: 384px;
      margin: 18px;
    }

    .square {
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      cursor: pointer;
    }

    .light { background: #EEE; }
    .dark  { background: #888; }
    .selected { outline: 2px solid red; }
  </style>
</head>
<body>
  <div class="window">
    <div class="titlebar">ORACLE Challenge - chess.exe</div>
    <div id="container"></div>
  </div>

  <script>
    const container = document.getElementById("container");
    const pieces = {
      r: "♜", n: "♞", b: "♝", q: "♛", k: "♚", p: "♟",
      R: "♖", N: "♘", B: "♗", Q: "♕", K: "♔", P: "♙"
    };

    let board = [
      "rnbqkbnr",
      "pppppppp",
      "........",
      "........",
      "........",
      "........",
      "PPPPPPPP",
      "RNBQKBNR"
    ].map(row => row.split(""));

    let selected = null;

    function drawBoard() {
      container.innerHTML = "";
      for (let y = 0; y < 8; y++) {
        for (let x = 0; x < 8; x++) {
          const square = document.createElement("div");
          square.className = "square " + ((x + y) % 2 === 0 ? "light" : "dark");
          square.dataset.x = x;
          square.dataset.y = y;
          const piece = board[y][x];
          square.textContent = pieces[piece] || "";

          square.onclick = () => handleClick(x, y);

          container.appendChild(square);
        }
      }
    }

    function handleClick(x, y) {
      if (selected) {
        const [sx, sy] = selected;
        const movingPiece = board[sy][sx];
        board[y][x] = movingPiece;
        board[sy][sx] = ".";
        selected = null;
        if (board.flat().filter(p => p === "k").length === 0) {
          alert("Black king defeated. ORACLE core compromised.");
        }
        drawBoard();
      } else if (/[RNBQKP]/.test(board[y][x])) {
        selected = [x, y];
        highlightSelected(x, y);
      }
    }

    function highlightSelected(x, y) {
      drawBoard();
      const cell = document.querySelector(`[data-x='${x}'][data-y='${y}']`);
      if (cell) cell.classList.add("selected");
    }

    drawBoard();
  </script>
</body>
</html>
